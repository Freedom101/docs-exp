"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[45326],{77016:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=t(85893),s=t(11151);const r={},i="Deploy with Ubuntu",l={id:"deploy/deploy-rocket.chat/additional-deployment-methods/deploy-with-ubuntu",title:"Deploy with Ubuntu",description:"Preparation Steps",source:"@site/docs/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-with-ubuntu.md",sourceDirName:"deploy/deploy-rocket.chat/additional-deployment-methods",slug:"/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-with-ubuntu",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-with-ubuntu",draft:!1,unlisted:!1,editUrl:"https://github.com/Freedom101/docs-exp/tree/main/my-website/docs/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-with-ubuntu.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Deploy with Kubernetes",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-with-kubernetes"},next:{title:"Plug-in Deployments",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/additional-deployment-methods/plug-in-deployments"}},a={},c=[{value:"Preparation Steps",id:"preparation-steps",level:2},{value:"Install Rocket.Chat on Ubuntu",id:"install-rocketchat-on-ubuntu",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"deploy-with-ubuntu",children:"Deploy with Ubuntu"}),"\n",(0,o.jsx)(n.h2,{id:"preparation-steps",children:"Preparation Steps"}),"\n",(0,o.jsxs)(n.p,{children:["Depending on the version of ",(0,o.jsx)(n.a,{href:"https://rocket.chat/",children:"Rocket.Chat"})," you want to install, check the ",(0,o.jsx)(n.a,{href:"https://github.com/RocketChat/Rocket.Chat/releases",children:"release notes"})," to see the supported engine versions for MongoDB and NodeJs, and install as recommended. "]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"MongoDB"})}),"\n",(0,o.jsxs)(n.p,{children:["Please refer to the official MongoDB documentation on ",(0,o.jsx)(n.a,{href:"https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-ubuntu/",children:"how to install MongoDB on Ubuntu"}),". "]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"NodeJS"})}),"\n",(0,o.jsxs)(n.p,{children:["Follow the ",(0,o.jsx)(n.a,{href:"https://github.com/nodesource/distributions/blob/master/README.md#debinstall",children:"official guide"})," to install NodeJS on Ubuntu. You can also use third-party tools like ",(0,o.jsx)(n.a,{href:"https://github.com/nvm-sh/nvm#installing-and-updating",children:"nvm"})," or ",(0,o.jsx)(n.a,{href:"https://www.npmjs.com/package/n",children:"n"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"install-rocketchat-on-ubuntu",children:"Install Rocket.Chat on Ubuntu"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Install the required packages/dependencies."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo apt install -y curl build-essential graphicsmagick\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Download and extract the ",(0,o.jsx)(n.a,{href:"https://github.com/RocketChat/Rocket.Chat/releases/latest",children:"latest release "}),"of Rocket.Chat."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"curl -L https://releases.rocket.chat/latest/download -o /tmp/rocket.chat.tgz\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Extract the Rocket.Chat server files using these commands:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"tar -xzf /tmp/rocket.chat.tgz -C /tmp\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd /tmp/bundle/programs/server && npm install --production\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsxs)(n.p,{children:["When executing ",(0,o.jsx)(n.code,{children:"npm install"}),", it is recommended to operate using a non-root account. Alternatively, you can utilize the ",(0,o.jsx)(n.code,{children:"npm install --unsafe-perm --production"})," command. This approach eliminates the necessity for building libc or upgrading the host system."]})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Move the extracted files to the ",(0,o.jsx)(n.em,{children:"/opt"})," directory."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo mv /tmp/bundle /opt/Rocket.Chat\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["This guide uses the ",(0,o.jsx)(n.em,{children:"/opt directory"}),". However, you can choose your preferred directory."]})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Configure the Rocket.Chat service"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Add the rocketchat user and set the right permissions on the Rocket.Chat folder."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo useradd -M rocketchat && sudo usermod -L rocketchat\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo chown -R rocketchat:rocketchat /opt/Rocket.Chat\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Depending on how you install NodeJS, the binary path may be different. Save the path to a variable."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"NODE_PATH=$(which node)\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Now, save the systemd service file."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cat << EOF |sudo tee -a /lib/systemd/system/rocketchat.service\n[Unit]\nDescription=The Rocket.Chat server\nAfter=network.target remote-fs.target nss-lookup.target nginx.service mongod.service\n[Service]\nExecStart=$NODE_PATH /opt/Rocket.Chat/main.js\nStandardOutput=syslog\nStandardError=syslog\nSyslogIdentifier=rocketchat\nUser=rocketchat\n[Install]\nWantedBy=multi-user.target\nEOF\n"})}),"\n",(0,o.jsx)(n.p,{children:"The command above will create a barebone service file; this service file is what systemd will use to start your Rocket.Chat daemon/process."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Passing environment variables"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Pass some environment variables to the running process. See  ",(0,o.jsx)(n.a,{href:"https://docs.rocket.chat/deploy/rocket.chat-environment-configuration/environment-variables",children:"Rocket.Chat environmental variables"})," for more details. To update the Rocket.Chat file, run the following command :"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sudo systemctl edit rocketchat\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Update the text editor with the information below and save."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"[Service]\nEnvironment=ROOT_URL=http://localhost:3000\nEnvironment=PORT=3000\nEnvironment=MONGO_URL=mongodb://localhost:27017/rocketchat?replicaSet=rs01\nEnvironment=MONGO_OPLOG_URL=mongodb://localhost:27017/local?replicaSet=rs01\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"MongoDB Configuration"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Open the MongoDB config file (",(0,o.jsx)(n.code,{children:"/etc/mongod.conf"}),") in your preferred text editor. "]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"nano /etc/mongod.conf\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Set the storage engine to ",(0,o.jsx)(n.code,{children:"wiredTiger"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"storage:\n  engine: wiredTiger\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Enable replication, and name the replicaset ",(0,o.jsx)(n.code,{children:"rs01"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"replication:\n  replSetName: rs01\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsx)(n.p,{children:"The MongoDB replica set is mandatory for Rocket.Chat > 1.0.0."})}),"\n",(0,o.jsx)(n.p,{children:"Your MongoDB config file should look something like the following:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"storage:\n  dbPath: /var/lib/mongodb\n  journal:\n    enabled: true\n  engine: wiredTiger\n\nsystemLog:\n  destination: file\n  logAppend: true\n  path: /var/log/mongodb/mongod.log\n\nnet:\n  port: 27017\n  bindIp: 127.0.0.1\n\nprocessManagement:\n  fork: true\n  timeZoneInfo: /usr/share/zoneinfo\n\nreplication:\n  replSetName: rs01\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["Read the ",(0,o.jsx)(n.a,{href:"https://docs.mongodb.org/manual/reference/configuration-options/",children:"official documentation"})," for a complete list of available MongoDB config options."]})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Start MongoDB with the following command:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo systemctl enable --now mongod\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Then, initiate  replica set with this command:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'mongo --eval "printjson(rs.initiate())"\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"You can start your Rocket.Chat workspace now using this command:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo systemctl enable --now rocketchat\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Configure your Rocket.Chat server"})}),"\n",(0,o.jsxs)(n.p,{children:["To access your Rocket.Chat workspace, open a web browser and navigate to the specified ROOT URL (",(0,o.jsx)(n.a,{href:"http://your-host-name.com-as-accessed-from-internet:3000",children:"http://your-host-name.com-as-accessed-from-internet:3000"}),"). Follow the configuration prompts to ",(0,o.jsx)(n.a,{href:"https://docs.rocket.chat/setup-and-configure/accessing-your-workspace/rocket.chat-setup-wizard#setup-wizard",children:"configure your workspace."})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Optional Configurations"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://docs.rocket.chat/deploy/rocket.chat-environment-configuration/optional-configurations",children:"Configure firewall rule"})," "]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://docs.rocket.chat/deploy/rocket.chat-environment-configuration/configuring-ssl-reverse-proxy",children:"Configure an HTTP reverse proxy to access Rocket.Chat server"})," "]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>i});var o=t(67294);const s={},r=o.createContext(s);function i(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);