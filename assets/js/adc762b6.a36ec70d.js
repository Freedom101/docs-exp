"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[13192],{83718:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>a,contentTitle:()=>s,default:()=>g,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var t=o(85893),i=o(11151);const r={},s="Additional MongoDB Driver Options",c={id:"setup-and-configure/environment-configuration/mongodb-configuration/additional-mongodb-driver-options",title:"Additional MongoDB Driver Options",description:"It's possible to provide extra connection settings to the Mongo driver that are not covered in the URI connection string. Set the the MONGO_OPTIONS environment variable to a JSON string.&#x20;",source:"@site/docs/setup-and-configure/environment-configuration/mongodb-configuration/additional-mongodb-driver-options.md",sourceDirName:"setup-and-configure/environment-configuration/mongodb-configuration",slug:"/setup-and-configure/environment-configuration/mongodb-configuration/additional-mongodb-driver-options",permalink:"/docs-exp/docs/setup-and-configure/environment-configuration/mongodb-configuration/additional-mongodb-driver-options",draft:!1,unlisted:!1,editUrl:"https://github.com/Freedom101/docs-exp/tree/main/my-website/docs/setup-and-configure/environment-configuration/mongodb-configuration/additional-mongodb-driver-options.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"MongoDB Configuration",permalink:"/docs-exp/docs/setup-and-configure/environment-configuration/mongodb-configuration/"},next:{title:"Configure a Replica Set for MongoDB",permalink:"/docs-exp/docs/setup-and-configure/environment-configuration/mongodb-configuration/configure-a-replica-set-for-mongodb"}},a={},d=[];function p(n){const e={a:"a",code:"code",h1:"h1",p:"p",pre:"pre",...(0,i.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"additional-mongodb-driver-options",children:"Additional MongoDB Driver Options"}),"\n",(0,t.jsxs)(e.p,{children:["It's possible to provide extra ",(0,t.jsx)(e.a,{href:"http://mongodb.github.io/node-mongodb-native/3.5/reference/connecting/connection-settings/",children:"connection settings"})," to the Mongo driver that are not covered in the URI connection string. Set the the ",(0,t.jsx)(e.code,{children:"MONGO_OPTIONS"})," environment variable to a JSON string. "]}),"\n",(0,t.jsx)(e.p,{children:"For example:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# we need to pass the contents of PEMs, etc in a format compatible with JSON, so add \'\\n\' to the end of each line.\nexport TLS_CRT=$(cat /pems/tls.crt | awk \'{printf "%s\\\\n",$0} END {print ""}\')\nexport PEM=$(cat /pems/mongo.pem | awk \'{printf "%s\\\\n",$0} END {print ""}\')\nexport KEY=$(cat /pems/mongo.key | awk \'{printf "%s\\\\n",$0} END {print ""}\')\n# now insert all the credentials into the JSON OPTIONS string\nexport MONGO_OPTIONS=\'{"sslCA":["\'${TLS_CRT}\'"],"sslCert":"\'${PEM}\'","sslKey":"\'${KEY}\'"}\'\n'})}),"\n",(0,t.jsxs)(e.p,{children:["You might want to do this, for example, if you're backing Rocket.Chat with a TLS-secured Mongo ",(0,t.jsx)(e.a,{href:"https://docs.mongodb.com/manual/replication/",children:"replica set"})," and need to pass certificates/PEM files, etc. to connect to it."]}),"\n",(0,t.jsx)(e.p,{children:"If you see the following error during startup:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"MongoTimeoutError: Server selection timed out after 10000 ms\n"})}),"\n",(0,t.jsxs)(e.p,{children:["You can try increasing server selection time by adding the following property to ",(0,t.jsx)(e.code,{children:"MONGO_OPTIONS"})," to change the default value of ",(0,t.jsx)(e.code,{children:"10000"})," to ",(0,t.jsx)(e.code,{children:"20000"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"MONGO_OPTIONS='{ \"serverSelectionTimeoutMS\": 20000 }'\n"})})]})}function g(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(p,{...n})}):p(n)}},11151:(n,e,o)=>{o.d(e,{Z:()=>c,a:()=>s});var t=o(67294);const i={},r=t.createContext(i);function s(n){const e=t.useContext(r);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);