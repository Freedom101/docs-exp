"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4377],{668:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var t=o(74848),s=o(28453);const i={description:"Set up an Ansible environment for deploying Rocket.Chat to multiple servers."},l="Ansible",r={id:"deploy/deploy-rocket.chat/scaling-rocket.chat/automation-tools/ansible",title:"Ansible",description:"Set up an Ansible environment for deploying Rocket.Chat to multiple servers.",source:"@site/docs/deploy/deploy-rocket.chat/scaling-rocket.chat/automation-tools/ansible.md",sourceDirName:"deploy/deploy-rocket.chat/scaling-rocket.chat/automation-tools",slug:"/deploy/deploy-rocket.chat/scaling-rocket.chat/automation-tools/ansible",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/scaling-rocket.chat/automation-tools/ansible",draft:!1,unlisted:!1,editUrl:"https://github.com/Freedom101/docs-exp/tree/main/my-website/docs/deploy/deploy-rocket.chat/scaling-rocket.chat/automation-tools/ansible.md",tags:[],version:"current",frontMatter:{description:"Set up an Ansible environment for deploying Rocket.Chat to multiple servers."},sidebar:"tutorialSidebar",previous:{title:"Automation Tools",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/scaling-rocket.chat/automation-tools/"},next:{title:"OpenShift",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/scaling-rocket.chat/automation-tools/openshift"}},a={},c=[{value:"Installation",id:"installation",level:2},{value:"Installation via package manager",id:"installation-via-package-manager",level:3},{value:"Installation via PIP",id:"installation-via-pip",level:3},{value:"Simple Deployment Environment for Rocket.Chat",id:"simple-deployment-environment-for-rocketchat",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Inventory set-up",id:"inventory-set-up",level:3},{value:"Download the Rocket.Chat Ansible role",id:"download-the-rocketchat-ansible-role",level:3},{value:"Create a Playbook to &quot;play&quot; the Rocket.Chat Ansible Role",id:"create-a-playbook-to-play-the-rocketchat-ansible-role",level:3},{value:"Deploy Rocket.Chat using Ansible",id:"deploy-rocketchat-using-ansible",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"ansible",children:"Ansible"}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["See the ",(0,t.jsx)(n.a,{href:"https://galaxy.ansible.com/RocketChat/Server#readme",children:"Rocket.Chat official Ansible role"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.p,{children:"Ansible works on a \"push to clients\" basis. Your control node pushes all the configuration/ad-hoc tasks out to your systems via SSH, with no client running on the systems you're deploying to! In order words, it's swift, efficient, secure, scalable, and highly portable. Therefore, to control remote systems, you only need to install Ansible on your control node (your desktop can be an excellent control node to deploy from). Ansible has "}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["To learn more about Ansible installation on different operating systems, see the ",(0,t.jsx)(n.a,{href:"https://docs.ansible.com/ansible/latest/installation_guide/index.html",children:"official installation guide"}),"."]})}),"\n",(0,t.jsx)(n.h3,{id:"installation-via-package-manager",children:"Installation via package manager"}),"\n",(0,t.jsx)(n.p,{children:"Ansible is likely available in your official package repositories if you're using a UNIX-like operating system, such as Linux or BSD. Use your package manager to see if it's available and install it."}),"\n",(0,t.jsx)(n.h3,{id:"installation-via-pip",children:"Installation via PIP"}),"\n",(0,t.jsxs)(n.p,{children:["Ansible is written in Python, so it's only natural that it be available for installation via ",(0,t.jsx)(n.a,{href:"https://pypi.python.org/pypi",children:(0,t.jsx)(n.code,{children:"pip"})}),". . If you have pip installed, run the following command:"]}),"\n",(0,t.jsxs)(n.p,{children:[" ",(0,t.jsx)(n.code,{children:"sudo pip install ansible"})]}),"\n",(0,t.jsxs)(n.p,{children:["If you do not have pip, check  if you can install ",(0,t.jsx)(n.code,{children:"pip"})," through your system's package manager (look out for Python 2.7 version). If you're on Mac OS X and you're not using ",(0,t.jsx)(n.a,{href:"http://brew.sh",children:"Homebrew"})," or ",(0,t.jsx)(n.a,{href:"https://github.com/cmacrae/saveosx",children:"pkgsrc"}),", you should be able to install ",(0,t.jsx)(n.code,{children:"pip"})," using ",(0,t.jsx)(n.code,{children:"easy_install"})," with this command:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo easy_install pip \nsudo pip install ansible\n"})}),"\n",(0,t.jsx)(n.h2,{id:"simple-deployment-environment-for-rocketchat",children:"Simple Deployment Environment for Rocket.Chat"}),"\n",(0,t.jsx)(n.p,{children:"Now that you've installed Ansible, you can deploy Rocket.Chat."}),"\n",(0,t.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["You must have SSH access to the system you want to deploy to, as the ",(0,t.jsx)(n.code,{children:"root"})," user."]}),"\n",(0,t.jsxs)(n.li,{children:["The system you're deploying to must have Python installed and run one of the following operating systems:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"EL 7 (RHEL/CentOS)"}),"\n",(0,t.jsx)(n.li,{children:"Debian 8 (Jessie) LTS"}),"\n",(0,t.jsx)(n.li,{children:"Ubuntu 18.04 LTS"}),"\n",(0,t.jsx)(n.li,{children:"Ubuntu 19.04"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["Future releases of the ",(0,t.jsx)(n.a,{href:"https://galaxy.ansible.com/RocketChat/Server/#readme",children:"official Rocket.Chat Ansible role"})," will include other operating systems and Linux distributions/releases. If you'd like to see a particular OS supported, please ",(0,t.jsx)(n.a,{href:"https://github.com/RocketChat/Rocket.Chat.Ansible/issues",children:"raise an issue"})," to ask if it can be added."]})}),"\n",(0,t.jsx)(n.h3,{id:"inventory-set-up",children:"Inventory set-up"}),"\n",(0,t.jsx)(n.p,{children:"Create a directory anywhere on your system, possibly in your home directory or where you save your code or Git repositories. Give it a name and navigate to that directory."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"mkdir ansible\ncd ansible\nansible $\n"})}),"\n",(0,t.jsx)(n.p,{children:"Next, create an inventory file in that directory. The inventory file is a simple formatted file containing a list of systems we want to connect to and control using Ansible. It can include single hosts, group hosts together, groups of groups, and set variables on a host or group basis. "}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:[" We recommend naming the directory ",(0,t.jsx)(n.code,{children:"ansible"})," and the file ",(0,t.jsx)(n.code,{children:"inventory"})," to maintain a proper naming convention."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"touch inventory\n"})}),"\n",(0,t.jsx)(n.p,{children:"Open the file and add the hostname or FQDN of the server(s) you want to deploy Rocket.Chat to."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"chat.my.domain\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"[chat_servers]"}),' denotes a group called "chat_servers." Any hostnames/FQDNs/IP addresses under this will be members of the "chat_servers" group. If you want to add another server, add it like this:']}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[chat_servers]\nchat.my.domain\ntalk.my.domain\n"})}),"\n",(0,t.jsx)(n.p,{children:"We recommend authenticating SSH connections to your server(s) using SSH key pairs. However, you can provide Ansible with the root user's password in the inventory file if you don't have SSH. "}),"\n",(0,t.jsx)(n.admonition,{type:"danger",children:(0,t.jsx)(n.p,{children:"This should only be temporary because it is an insecure practice."})}),"\n",(0,t.jsxs)(n.p,{children:["Set the ",(0,t.jsx)(n.code,{children:"root"})," user's password for the ",(0,t.jsx)(n.code,{children:"chat.my.domain"})," host:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[chat_servers]\nchat.my.domain ansible_ssh_pass=SuP3rseCre7pA$sw0rd\ntalk.my.domain\n"})}),"\n",(0,t.jsx)(n.h3,{id:"download-the-rocketchat-ansible-role",children:"Download the Rocket.Chat Ansible role"}),"\n",(0,t.jsxs)(n.p,{children:["Ansible shares and uses other people's roles through ",(0,t.jsx)(n.a,{href:"http://galaxy.ansible.com",children:"Galaxy"}),". You can download the roles you want using a command-line tool installed earlier when you installed Ansible."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:" ansible-galaxy.\n"})}),"\n",(0,t.jsxs)(n.p,{children:["First, create a ",(0,t.jsx)(n.code,{children:"roles"})," directory:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ansible $ mkdir roles\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Then, create a ",(0,t.jsx)(n.code,{children:"requirements.yml"})," file describing how we want to fetch the role to ",(0,t.jsx)(n.code,{children:"ansible-galaxy"}),". Open the file ",(0,t.jsx)(n.code,{children:"roles/requirements.yml"}),".The file's contents will vary based on which version of Ansible you're running."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["Run ",(0,t.jsx)(n.code,{children:"ansible --version"})," to know your version of Ansible."]})}),"\n",(0,t.jsxs)(n.p,{children:["If you're running Ansible 1.9.4,  update ",(0,t.jsx)(n.code,{children:"requirements.yml"})," with the following data:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"- src: RocketChat.Server\n  version: master\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If you're running Ansible 2.0, update  ",(0,t.jsx)(n.code,{children:"requirements.yml"})," with the following data:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"  - src: RocketChat.Server\n    version: v2.2.2\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Next, fetch the Rocket.Chat Ansible role using the ",(0,t.jsx)(n.code,{children:"ansible-galaxy"})," command:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ansible-galaxy install -p roles/ -r roles/requirements.yml\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This command installs any roles defined ",(0,t.jsx)(n.code,{children:"requirements.yml"}),". Now you have the ",(0,t.jsx)(n.code,{children:"RocketChat.Server"})," role in your ",(0,t.jsx)(n.code,{children:"roles"})," directory."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ls roles\nRocketChat.Server\n"})}),"\n",(0,t.jsx)(n.h3,{id:"create-a-playbook-to-play-the-rocketchat-ansible-role",children:'Create a Playbook to "play" the Rocket.Chat Ansible Role'}),"\n",(0,t.jsx)(n.p,{children:'Ansible roles are built from a collection of "plays" - essentially, tasks/actions to take. To use a role, create a simple playbook that tells Ansible, "I want to run this role on these systems."'}),"\n",(0,t.jsxs)(n.p,{children:["Let's call the playbook ",(0,t.jsx)(n.code,{children:"rocket_chat.yml"})," ."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:".yml"})," denotes a YAML document, which is what language you use to express most things in Ansible."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"touch rocket_chat.yml\n"})}),"\n",(0,t.jsxs)(n.p,{children:[" Add the following information  to your ",(0,t.jsx)(n.code,{children:"rocket_chat.yml"})," playbook:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"---\n\n  - name: Apply the RocketChat.Server role to all chat_servers\n    hosts: chat_servers\n\n    roles:\n      - RocketChat.Server\n"})}),"\n",(0,t.jsx)(n.h3,{id:"deploy-rocketchat-using-ansible",children:"Deploy Rocket.Chat using Ansible"}),"\n",(0,t.jsxs)(n.p,{children:["To run the playbook, use the ",(0,t.jsx)(n.code,{children:"ansible-playbook"})," command, "]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ansible-playbook -i inventory rocket_chat.yml\n"})}),"\n",(0,t.jsxs)(n.p,{children:['This command can be expressed as "run the ',(0,t.jsx)(n.code,{children:"rocket_chat.yml"})," playbook with the inventory file ",(0,t.jsx)(n.code,{children:"inventory"}),'." When the deployment is successful, visit  ',(0,t.jsx)(n.code,{children:"https://chat.my.domain"})," and the Rocket.Chat login screen appears."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["See the ",(0,t.jsx)(n.a,{href:"https://github.com/RocketChat/Rocket.Chat.Ansible/blob/master/README.md",children:"README"})," to explore other Ansible role options."]})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>l,x:()=>r});var t=o(96540);const s={},i=t.createContext(s);function l(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);