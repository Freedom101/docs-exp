"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[68997],{95213:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var o=n(85893),r=n(11151);const t={description:"Configure file upload and storage"},i="File Upload",l={id:"use-rocket.chat/workspace-administration/settings/file-upload/README",title:"File Upload",description:"Configure file upload and storage",source:"@site/docs/use-rocket.chat/workspace-administration/settings/file-upload/README.md",sourceDirName:"use-rocket.chat/workspace-administration/settings/file-upload",slug:"/use-rocket.chat/workspace-administration/settings/file-upload/",permalink:"/docs-exp/docs/use-rocket.chat/workspace-administration/settings/file-upload/",draft:!1,unlisted:!1,editUrl:"https://github.com/Freedom101/docs-exp/tree/main/my-website/docs/use-rocket.chat/workspace-administration/settings/file-upload/README.md",tags:[],version:"current",frontMatter:{description:"Configure file upload and storage"},sidebar:"tutorialSidebar",previous:{title:"Cross-server Federated Channels",permalink:"/docs-exp/docs/use-rocket.chat/workspace-administration/settings/federation/rocket.chat-federation/cross-server-federated-channels"},next:{title:"File Upload FAQs",permalink:"/docs-exp/docs/use-rocket.chat/workspace-administration/settings/file-upload/file-upload-faqs"}},a={},c=[{value:"General Settings",id:"general-settings",level:2},{value:"Amazon S3",id:"amazon-s3",level:2},{value:"FileSystem",id:"filesystem",level:2},{value:"Google Cloud Storage",id:"google-cloud-storage",level:2},{value:"More Information",id:"more-information",level:3},{value:"WebDAV",id:"webdav",level:2}];function d(e){const s={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components},{Details:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.h1,{id:"file-upload",children:"File Upload"}),"\n",(0,o.jsx)(s.p,{children:"Configure file uploads and storage on your workspace. "}),"\n",(0,o.jsxs)(s.p,{children:["To access the menu on your workspace, navigate to ",(0,o.jsx)(s.strong,{children:"Administration > Workspace > Settings > File Upload"})]}),"\n",(0,o.jsx)(s.admonition,{type:"info",children:(0,o.jsxs)(s.p,{children:["Remember always to hit ",(0,o.jsx)(s.strong,{children:"Save Changes"})," to apply any changes made."]})}),"\n",(0,o.jsx)(s.h2,{id:"general-settings",children:"General Settings"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"File Uploads Enabled"}),": Use this setting to enable or restrict file uploads on your workspace"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Maximum File Upload Size (in bytes)"}),": Use this setting to define the maximum allowed file size for uploads. ",(0,o.jsx)(s.code,{children:"Set it to -1 to remove the file size limitation."}),(0,o.jsx)(s.br,{}),"\n","Make sure the maximum file upload size matches that of your proxy if any is used."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Accepted Media Types"}),": Use this setting to define the files the users can upload."]}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:"Comma-separated list of media types. Leave it blank for accepting all media types."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Blocked Media Types"}),": Define what types of files are blocked on the workspace."]}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:"Comma-separated list of media types. This setting has priority over the Accepted Media Types."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Protect Uploaded Files"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Yes"}),": Only authenticated users can have access to the uploaded files."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"No"}),": If in possession of the uploaded file's URL, unauthenticated users can access and download said files."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Restrict files to rooms' members"}),": Restrict the access of files uploaded on rooms to the rooms' members only."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Rotate images on upload"}),": Turn on to enable image rotation. This affects the image quality."]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Enable JSON Web Tokens protection to file uploads"}),": Turn on to enable JWT protection on file uploads."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"File Upload Json Web Token Secret"}),": Set the JWT secret to be used."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Storage Type"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"AmazonS3"}),": Uses the ",(0,o.jsx)(s.a,{href:"./#amazon-s3",children:"Amazon S3"})," storage type"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Google Cloud Storage"}),": Uses the ",(0,o.jsx)(s.a,{href:"./#google-cloud-storage",children:"Google Cloud Storage"})," storage type"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"WebDAV"}),": Uses the ",(0,o.jsx)(s.a,{href:"./#webdav",children:"WebDav"})," storage type"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"FileSystem"}),": Uses the ",(0,o.jsx)(s.a,{href:"./#filesystem",children:"FileSystem"})," storage type"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"File Uploads Enabled in Direct Messages"}),": Use this setting to enable or restrict file uploads on Direct Messages"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"amazon-s3",children:"Amazon S3"}),"\n",(0,o.jsxs)(s.p,{children:["You can find a more detailed guide on how to set up your Amazon S3 server ",(0,o.jsx)(s.a,{href:"broken-reference",children:"here"}),"."]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Bucket name"}),": The bucket name you've created on Amazon S3"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Acl"}),"(Optional): A ",(0,o.jsx)(s.em,{children:"Canned ACL"})," configuration (see a complete list ",(0,o.jsx)(s.a,{href:"http://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#canned-acl",children:"here"}),")"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Access Key"}),": Your Amazon Access Key ID (optional)"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Secret Key"}),": Your Amazon Secret Access Key (optional)"]}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Note"}),": If no ",(0,o.jsx)(s.code,{children:"AWSAccessKeyId"})," and ",(0,o.jsx)(s.code,{children:"AWSSecretAccessKey"})," are set, the underlying AWS SDK the will fallback to trying to retrieve credentials from the ",(0,o.jsx)(s.a,{href:"https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/setting-credentials-node.html",children:"usual locations"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"CDN Domain for Downloads"}),"(Optional): If you had set a CDN for your bucket, put it here"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Region"}),"(Optional): If you have created your bucket on region different from the US Standard, you ",(0,o.jsx)(s.strong,{children:"have"})," to set their code here (see a list of region codes ",(0,o.jsx)(s.a,{href:"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-available-regions",children:"here"}),")"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Bucket URL"}),"(Optional): Override the URL to which files are uploaded. This URL is also used for downloads unless a CDN is given"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Signature Version"}),": Identifies the version of AWS Signature that you want to support for authenticated requests."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Force Path Style"}),": Enable force path style."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"URLs Expiration Timespan"}),": Time after which Amazon S3 generated URLs are no longer valid (in seconds). If set to less than 5 seconds, this field is ignored."]}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:"If you run into issues with files not loading consistently for some users located further from server location. Increasing this time might help."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Proxy Avatars"}),": Proxy avatar file transmissions through your server instead of direct access to the asset's URL"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Proxy Uploads"}),": Proxy upload file transmissions through your server instead of direct access to the asset's URL"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n,{children:[(0,o.jsx)("summary",{children:"Amazon S3 CORS Configuration"}),(0,o.jsxs)(s.p,{children:["Set the following ",(0,o.jsx)(s.em,{children:"CORS Configuration"})," to your bucket."]}),(0,o.jsx)(s.p,{children:"XML format (if using the old AWS console Interface):"}),(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-markup",children:'[\n    {\n        "AllowedHeaders": [\n            "*"  \n        ],\n        "AllowedMethods": [\n            "PUT",\n            "POST",\n            "GET",\n            "HEAD"\n        ],  \n        "AllowedOrigins": [\n            "*ROCKET_CHAT_DOMAIN*"\n        ],  \n        "ExposeHeaders": [], \n        "MaxAgeSeconds": 3000\n    } \n]\n'})}),(0,o.jsx)(s.p,{children:"JSON format (if using the new AWS console Interface):"}),(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-javascript",children:'[\n  {\n    "AllowedHeaders": [\n        "*"\n    ],\n    "AllowedMethods": [\n        "PUT",\n        "POST",\n        "GET",\n        "HEAD"\n    ],\n    "AllowedOrigins": [\n        "*ROCKET_CHAT_DOMAIN*"\n    ],\n    "ExposeHeaders": [],\n    "MaxAgeSeconds": 3000\n  }\n]\n'})}),(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Note"}),": Replace ",(0,o.jsx)(s.code,{children:"*ROCKET_CHAT_DOMAIN*"})," with the domain of your Rocket.Chat installation, e.g. ",(0,o.jsx)(s.code,{children:"https://chat.example.com"}),".  Setting CORS to ",(0,o.jsx)(s.code,{children:"*"})," posses a security risk because it allows for requests from any host on the Internet."]})]}),"\n",(0,o.jsx)(s.h2,{id:"filesystem",children:"FileSystem"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"System Path"}),": The local path for where the uploaded files are stored. "]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"google-cloud-storage",children:"Google Cloud Storage"}),"\n",(0,o.jsxs)(s.p,{children:["The settings used when configuring a Google Cloud Storage server. You can find more details ",(0,o.jsx)(s.a,{href:"broken-reference",children:"here"}),"."]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Google Storage Bucket Name"}),": The bucket name to which the files should be uploaded."]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Google Storage Access Id"}),": The access ID (or username) of the service account which has access to your Cloud Storage bucket."]}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsxs)(s.p,{children:['The Access Id is generally in an email format, for example: "',(0,o.jsx)(s.a,{href:"mailto:example-test@example.iam.gserviceaccount.com",children:"example-test@example.iam.gserviceaccount.com"}),'"']}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Google Storage Secret"}),": A ",(0,o.jsx)(s.code,{children:".pem"})," containing your private key and certificate."]}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsxs)(s.p,{children:["You can find a guide ",(0,o.jsx)(s.a,{href:"https://github.com/CulturalMe/meteor-slingshot#google-cloud",children:"here"})," on how to get your keys."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Proxy Avatars"}),": Proxy avatar file transmissions through your server instead of direct access to the asset's URL"]}),"\n"]}),"\n",(0,o.jsxs)(s.li,{children:["\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Proxy Uploads"}),": Proxy upload file transmissions through your server instead of direct access to the asset's URL"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(s.h3,{id:"more-information",children:"More Information"}),"\n",(0,o.jsxs)(n,{children:[(0,o.jsxs)("summary",{children:["About ",(0,o.jsx)("strong",{children:"Google Storage Secret"})]}),(0,o.jsx)(s.p,{children:"The value here takes an argument of a PEM file to connect to your Cloud Storage bucket. When you create a service account, you have the ability to download a JSON file that contains a number of variables. You need the unescaped private key, along with one of the certificates linked at the bottom of the JSON."}),(0,o.jsx)(s.p,{children:"Syntax then looks just like a regular PEM file:"}),(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{children:"-----BEGIN PRIVATE KEY-----\nunescaped private key goes here\n-----END PRIVATE KEY-----\n----BEGIN CERTIFICATE-----\nfirst certificate goes here\n-----END CERTIFICATE-----\n"})}),(0,o.jsx)(s.p,{children:"Enter this into Rocket.Chat to allow the authentication with Google and store items in the bucket."})]}),"\n",(0,o.jsx)(s.h2,{id:"webdav",children:"WebDAV"}),"\n",(0,o.jsx)(s.p,{children:"The settings used for WebDAV as a storage server."}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Upload Folder Path"}),": WebDAV folder path to which files are uploaded to."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"WebDAV Server Access URL"}),": The URL of the WebDAV server (",(0,o.jsx)(s.a,{href:"https://community.cryptomator.org/t/webdav-urls-of-common-cloud-storage-services/75",children:"WebDAV URLs of Common Cloud Storage Services"}),")."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"WebDAV Username"}),": Username for the remote WebDav server."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"WebDAV Password"}),": Password for the remote WebDAV server."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Proxy Avatars"}),": Proxy avatar file transmissions through your server instead of direct access to the asset's URL."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Proxy Uploads"}),": Proxy uploads file transmissions through your server instead of directly accessing the asset's URL."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.a)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},11151:(e,s,n)=>{n.d(s,{Z:()=>l,a:()=>i});var o=n(67294);const r={},t=o.createContext(r);function i(e){const s=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(t.Provider,{value:s},e.children)}}}]);