"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[70407],{19216:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var i=n(85893),s=n(11151);const o={},r="TravisCI",a={id:"use-rocket.chat/workspace-administration/integrations/travis-ci",title:"TravisCI",description:"Add TravisCI notifications via a new WebHook in Rocket.Chat",source:"@site/docs/use-rocket.chat/workspace-administration/integrations/travis-ci.md",sourceDirName:"use-rocket.chat/workspace-administration/integrations",slug:"/use-rocket.chat/workspace-administration/integrations/travis-ci",permalink:"/docs-exp/docs/use-rocket.chat/workspace-administration/integrations/travis-ci",draft:!1,unlisted:!1,editUrl:"https://github.com/Freedom101/docs-exp/tree/main/my-website/docs/use-rocket.chat/workspace-administration/integrations/travis-ci.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Simple Telegram Bot",permalink:"/docs-exp/docs/use-rocket.chat/workspace-administration/integrations/simple-telegram-bot"},next:{title:"Uptime Robot",permalink:"/docs-exp/docs/use-rocket.chat/workspace-administration/integrations/uptime-robot"}},c={},l=[{value:"Receive alerts",id:"receive-alerts",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"travisci",children:"TravisCI"}),"\n",(0,i.jsx)(t.p,{children:"Add TravisCI notifications via a new WebHook in Rocket.Chat"}),"\n",(0,i.jsx)(t.h2,{id:"receive-alerts",children:"Receive alerts"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Create a new ",(0,i.jsx)(t.strong,{children:"Incoming WebHook"}),"."]}),"\n",(0,i.jsx)(t.li,{children:"Select the channel where you will receive the alerts. You may wish to create a dedicated channel for your notifications."}),"\n",(0,i.jsx)(t.li,{children:"Select an account from which the alerts will be posted. You may wish to create a dedicated account just for notifications."}),"\n",(0,i.jsxs)(t.li,{children:['Set the "Enable Scripts" option to ',(0,i.jsx)(t.code,{children:"True"}),"."]}),"\n",(0,i.jsx)(t.li,{children:"Copy scripts below and paste it in Script field."}),"\n",(0,i.jsx)(t.li,{children:"Save the integration. This will generate a webhook URL and secret for you."}),"\n",(0,i.jsxs)(t.li,{children:["In your ",(0,i.jsx)(t.code,{children:".travis.yml"})," file add WebHooks parameter with webhook URL generated."]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",children:"  notifications:\n      webhooks: <webhook_url_generated>\n"})}),"\n",(0,i.jsx)(t.p,{children:"This script will generate notifications for the following build events:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Build finished status for any pushed code"}),"\n",(0,i.jsx)(t.li,{children:"Build finished status for new Pull Request"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Screenshot of messages generated by TravisCI integration script",src:n(10347).Z+"",width:"1648",height:"320"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.em,{children:"Note:"})," If status is passed, message color is green otherwise it is red."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-javascript",children:"const buildMessage = (obj) => {\n  const min = Math.floor(obj.duration / 60);\n  const sec = obj.duration - min * 60;\n\n  let template = `Build [#${obj.number}](${obj.build_url})`;\n  template += ` ([${obj.commit.substring(0, 7)}](${obj.compare_url})) of`\n  template += ` ${obj.repository.owner_name}/${obj.repository.name}@${obj.branch}`;\n  if(obj.pull_request) {\n     let pr_url = `https://github.com/${obj.repository.owner_name}/`;\n     pr_url += `${obj.repository.name}/pull/${obj.pull_request_number}`;\n     template += ` in PR [#${obj.pull_request_number}](${pr_url})`;\n  }\n  template += ` by ${obj.author_name} ${obj.state} in ${min} min ${sec} sec`;\n\n  let status_color = '#36A64F';\n  if(obj.state !== 'passed') {\n    status_color = '#A63636'\n  }\n\n  return {\n    text: template,\n    color: status_color\n  };\n};\n\nclass Script {\n  process_incoming_request({ request }) {\n    msg = buildMessage(request.content);\n\n    return {\n      content:{\n        attachments: [\n          {\n            text: msg.text,\n            color: msg.color\n          }\n        ]\n      }\n    };\n  }\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["If you want more customizations, please look in TravisCI documentation: ",(0,i.jsx)(t.a,{href:"https://docs.travis-ci.com/user/notifications/#Configuring-webhook-notifications",children:"https://docs.travis-ci.com/user/notifications/#Configuring-webhook-notifications"})]})]})}function u(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},10347:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/travis-ci-9d2f9daf295abbd8b75441d617a8a7ab.png"},11151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>r});var i=n(67294);const s={},o=i.createContext(s);function r(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);