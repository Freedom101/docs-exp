"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[15401],{46425:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var t=o(74848),s=o(28453);const r={},i="Deploy on Debian",a={id:"deploy/deploy-rocket.chat/additional-deployment-methods/deploy-on-debian",title:"Deploy on Debian",description:"Preparation Steps",source:"@site/docs/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-on-debian.md",sourceDirName:"deploy/deploy-rocket.chat/additional-deployment-methods",slug:"/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-on-debian",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-on-debian",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-on-debian.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Additional Deployment Methods",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/additional-deployment-methods/"},next:{title:"Deploy on Google Compute Engine",permalink:"/docs-exp/docs/deploy/deploy-rocket.chat/additional-deployment-methods/deploy-on-google-compute-engine"}},l={},c=[{value:"Preparation Steps",id:"preparation-steps",level:2},{value:"Install Rocket.Chat on Debian",id:"install-rocketchat-on-debian",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"deploy-on-debian",children:"Deploy on Debian"}),"\n",(0,t.jsx)(n.h2,{id:"preparation-steps",children:"Preparation Steps"}),"\n",(0,t.jsx)(n.p,{children:"Depending on the version of Rocket.Chat you want to install, check the release notes to see the supported engine versions for MongoDB and NodeJs, and install as recommended. "}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Install MongoDB"})}),"\n",(0,t.jsx)(n.p,{children:"Please refer to the official MongoDB documentation on how to install MongoDB on Debian. For the list of supported versions, see our documentation here."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Install NodeJS"})}),"\n",(0,t.jsxs)(n.p,{children:["Follow the official guide to install NodeJS on a Debian system. Check out our page on supported node versions for your specific version. You can also use third-party tools like ",(0,t.jsx)(n.a,{href:"https://github.com/nvm-sh/nvm#installing-and-updating",children:"nvm"})," or ",(0,t.jsx)(n.a,{href:"https://www.npmjs.com/package/n",children:"n"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"install-rocketchat-on-debian",children:"Install Rocket.Chat on Debian"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Update your system by running this command:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt -y update\nsudo apt -y upgrade\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Install required packages/dependencies:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt install -y curl build-essential graphicsmagick\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"To download the latest Rocket.Chat version run the following command:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -L https://releases.rocket.chat/latest/download -o /tmp/rocket.chat.tgz\n"})}),"\n",(0,t.jsxs)(n.p,{children:["You can also use ",(0,t.jsx)(n.code,{children:"wget"}),"to download Rocket.Chat with this command:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"wget https://releases.rocket.chat/latest/download -O /tmp/rocket.chat.tgz\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To download a specific version, replace  ",(0,t.jsx)(n.code,{children:"latest"})," the version number."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"wget https://releases.rocket.chat/4.1.2/download -O /tmp/rocket.chat.tgz\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Extract the archive with ",(0,t.jsx)(n.code,{children:"tar"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"tar xzf /tmp/rocket.chat.tgz -C /tmp\n"})}),"\n",(0,t.jsxs)(n.p,{children:["You should now see a new directory under ",(0,t.jsx)(n.code,{children:"/tmp"})," named ",(0,t.jsx)(n.code,{children:"bundle"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Next, install all the node dependencies:"}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["When executing ",(0,t.jsx)(n.code,{children:"npm install"}),", it is recommended to operate using a non-root account. Alternatively, you can utilize the ",(0,t.jsx)(n.code,{children:"npm install --unsafe-perm"})," command. This approach eliminates the necessity for building libc or upgrading the host system."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"(cd /tmp/bundle/programs/server; npm i)\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"/tmp"})," has been a temporary non-root user-writable location to prepare the bundle. For this guide, we're going to use /opt to be the final location but you can choose any other. Whatever may it be, if not /opt, make sure you change the location in all the other places it is specified."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo mv /tmp/bundle /opt/Rocket.Chat\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Configure the Rocket.Chat service"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Add the rocketchat user, and set the right permissions on the Rocket.Chat folder."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo useradd -M rocketchat && sudo usermod -L rocketchat\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Create the Rocket.Chat service file:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo chown -R rocketchat:rocketchat /opt/Rocket.Chat\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Depending on how you install NodeJS, the binary path may be different. Save the path to a variable."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"NODE_PATH=$(which node)\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Now, save the systemd service file."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat << EOF |sudo tee -a /lib/systemd/system/rocketchat.service\n[Unit]\nDescription=The Rocket.Chat server\nAfter=network.target remote-fs.target nss-lookup.target nginx.service mongod.service\n[Service]\nExecStart=$NODE_PATH /opt/Rocket.Chat/main.js\nStandardOutput=syslog\nStandardError=syslog\nSyslogIdentifier=rocketchat\nUser=rocketchat\n[Install]\nWantedBy=multi-user.target\nEOF\n"})}),"\n",(0,t.jsx)(n.p,{children:"The command above will create a barebone service file, this service file is what systemd will use to start your Rocket.Chat daemon/process."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Passing environment variables"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Pass some environment variables to the running process. See  Rocket.Chat environmental variables for more details. To update the Rocket.Chat file, run the following command :"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo systemctl edit rocketchat\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Update the text editor with the information below and save."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"[Service]\nEnvironment=ROOT_URL=http://localhost:3000\nEnvironment=PORT=3000\nEnvironment=MONGO_URL=mongodb://localhost:27017/rocketchat?replicaSet=rs01\nEnvironment=MONGO_OPLOG_URL=mongodb://localhost:27017/local?replicaSet=rs01\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"MongoDB Configuration"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Open the MongoDB config file (",(0,t.jsx)(n.code,{children:"/etc/mongod.conf"}),") in your preferred text editor. "]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"nano /etc/mongod.conf\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Set the storage engine to ",(0,t.jsx)(n.code,{children:"wiredTiger"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"storage:\n  engine: wiredTiger\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Enable replication, and name the replicaset ",(0,t.jsx)(n.code,{children:"rs01"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"replication:\n  replSetName: rs01\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"The MongoDB replica set is mandatory for Rocket.Chat > 1.0.0."})}),"\n",(0,t.jsx)(n.p,{children:"Your MongoDB config file should look something like the following:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"storage:\n  dbPath: /var/lib/mongodb\n  journal:\n    enabled: true\n  engine: wiredTiger\n\nsystemLog:\n  destination: file\n  logAppend: true\n  path: /var/log/mongodb/mongod.log\n\nnet:\n  port: 27017\n  bindIp: 127.0.0.1\n\nprocessManagement:\n  fork: true\n  timeZoneInfo: /usr/share/zoneinfo\n\nreplication:\n  replSetName: rs01\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Read the official documentation for a complete list of available MongoDB config options."})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Start MongoDB with the following command:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl enable --now mongod\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Then, initiate  replica set with this command:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'mongo --eval "printjson(rs.initiate())"\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You can start your Rocket.Chat workspace now using this command:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl enable --now rocketchat\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Configure your Rocket.Chat server"})}),"\n",(0,t.jsxs)(n.p,{children:["To access your Rocket.Chat workspace, open a web browser and navigate to the specified ROOT URL (",(0,t.jsx)(n.a,{href:"http://your-host-name.com-as-accessed-from-internet:3000",children:"http://your-host-name.com-as-accessed-from-internet:3000"}),"). Follow the configuration prompts to ",(0,t.jsx)(n.a,{href:"https://docs.rocket.chat/setup-and-configure/accessing-your-workspace/rocket.chat-setup-wizard#setup-wizard",children:"configure your workspace."})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs-exp/docs/setup-and-configure/environment-configuration/firewall-configuration",children:"Configure firewall rule"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs-exp/docs/setup-and-configure/environment-configuration/configuring-ssl-reverse-proxy",children:"Configure a HTTP reverse proxy to access Rocket.Chat server"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs-exp/docs/setup-and-configure/environment-configuration/mongodb-configuration/mongodb-uri-authentication",children:"Configure mongo access control"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs-exp/docs/setup-and-configure/environment-configuration/mongodb-configuration/additional-mongodb-driver-options",children:"Configure production values for mongodb"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>a});var t=o(96540);const s={},r=t.createContext(s);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);