"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[68472],{67224:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>n,metadata:()=>c,toc:()=>l});var i=t(74848),r=t(28453);const n={},d="Microsoft Teams Bridge",c={id:"extend-rocket.chat-capabilities/rocket.chat-marketplace/rocket.chat-public-apps-guides/microsoft-teams-bridge/README",title:"Microsoft Teams Bridge",description:"Microsoft Teams Bridge is an app that connects collaborators across Rocket.Chat and Microsoft Teams. It acts as a bridge between Teams and Rocket.Chat to enable cross-platform messaging among users in an organization. This way, users can send and receive messages from their workspace or Teams account.",source:"@site/docs/extend-rocket.chat-capabilities/rocket.chat-marketplace/rocket.chat-public-apps-guides/microsoft-teams-bridge/README.md",sourceDirName:"extend-rocket.chat-capabilities/rocket.chat-marketplace/rocket.chat-public-apps-guides/microsoft-teams-bridge",slug:"/extend-rocket.chat-capabilities/rocket.chat-marketplace/rocket.chat-public-apps-guides/microsoft-teams-bridge/",permalink:"/docs-exp/docs/extend-rocket.chat-capabilities/rocket.chat-marketplace/rocket.chat-public-apps-guides/microsoft-teams-bridge/",draft:!1,unlisted:!1,editUrl:"https://github.com/Freedom101/docs-exp/tree/main/my-website/docs/extend-rocket.chat-capabilities/rocket.chat-marketplace/rocket.chat-public-apps-guides/microsoft-teams-bridge/README.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Using the Google Drive App",permalink:"/docs-exp/docs/extend-rocket.chat-capabilities/rocket.chat-marketplace/rocket.chat-public-apps-guides/google-drive/using-the-google-drive-app"},next:{title:"Using Microsoft Teams Bridge",permalink:"/docs-exp/docs/extend-rocket.chat-capabilities/rocket.chat-marketplace/rocket.chat-public-apps-guides/microsoft-teams-bridge/using-microsoft-teams-bridge"}},a={},l=[{value:"Setup Microsoft Teams Bridge",id:"setup-microsoft-teams-bridge",level:2},{value:"Set up an Azure Active Directory App",id:"set-up-an-azure-active-directory-app",level:3},{value:"Configure Microsoft Teams Bridge",id:"configure-microsoft-teams-bridge",level:3},{value:"API Limitation",id:"api-limitation",level:2}];function o(e){const s={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h1,{id:"microsoft-teams-bridge",children:"Microsoft Teams Bridge"}),"\n",(0,i.jsxs)(s.p,{children:["Microsoft Teams Bridge is an app that connects collaborators across Rocket.Chat and Microsoft Teams. It acts as a bridge between ",(0,i.jsx)(s.strong,{children:"Teams"})," and ",(0,i.jsx)(s.strong,{children:"Rocket.Chat"})," to enable cross-platform messaging among users in an organization. This way, users can send and receive messages from their workspace or Teams account."]}),"\n",(0,i.jsx)(s.admonition,{type:"info",children:(0,i.jsx)(s.p,{children:"It supports other message formats, such as emojis, files, and links. Furthermore, operations like editing or deleting a message are also supported."})}),"\n",(0,i.jsx)(s.h2,{id:"setup-microsoft-teams-bridge",children:"Setup Microsoft Teams Bridge"}),"\n",(0,i.jsx)(s.admonition,{type:"info",children:(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.strong,{children:"Microsoft Teams Bridge app"})," is only available for workspaces on version ",(0,i.jsx)(s.code,{children:"6.1"})," and above."]})}),"\n",(0,i.jsx)(s.p,{children:"As an administrator, ensure you have access to the Rocket.Chat admin account and Teams admin account for your organization before installing."}),"\n",(0,i.jsxs)(s.p,{children:["To install ",(0,i.jsx)(s.strong,{children:"Microsoft Teams Bridge"}),","]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Go to ",(0,i.jsx)(s.strong,{children:"Administration > Apps > Marketplace."})]}),"\n",(0,i.jsxs)(s.li,{children:["Search for the ",(0,i.jsx)(s.strong,{children:"Microsoft Teams Bridge"})," app."]}),"\n",(0,i.jsxs)(s.li,{children:["Click ",(0,i.jsx)(s.strong,{children:"Install."})," Confirm that the app is enabled."]}),"\n",(0,i.jsxs)(s.li,{children:["On the ",(0,i.jsx)(s.strong,{children:"Microsoft Teams Bridge"})," ",(0,i.jsx)(s.strong,{children:"App Info"})," screen, navigate to ",(0,i.jsx)(s.strong,{children:"Details > API and"})," copy the ",(0,i.jsx)(s.code,{children:"GET auth endpoint URL"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.admonition,{type:"info",children:(0,i.jsx)(s.p,{children:"If it's a localhost URL, exposing the localhost port to the internet requires a tunnel service like Ngrok."})}),"\n",(0,i.jsx)(s.h3,{id:"set-up-an-azure-active-directory-app",children:"Set up an Azure Active Directory App"}),"\n",(0,i.jsx)(s.admonition,{type:"warning",children:(0,i.jsxs)(s.p,{children:["Azure Active Directory is now Microsoft Entra ID. See the ",(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/new-name",children:"official documentation"})," for more details."]})}),"\n",(0,i.jsx)(s.p,{children:"To set up  Microsoft Entra ID for your organization,"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Login to",(0,i.jsx)(s.a,{href:"https://portal.azure.com/",children:" Microsoft Azure Portal "}),"with your organization's Teams admin account."]}),"\n",(0,i.jsxs)(s.li,{children:["Find and click ",(0,i.jsx)(s.strong,{children:"Microsoft Entra ID"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Click ",(0,i.jsx)(s.strong,{children:"Add"}),". Then, select ",(0,i.jsx)(s.strong,{children:"App registration"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Give the app a name. Select ",(0,i.jsx)(s.strong,{children:"Accounts in this organizational directory only"})," as the ",(0,i.jsx)(s.strong,{children:"Supported account type"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Select ",(0,i.jsx)(s.strong,{children:"Web"})," as the ",(0,i.jsx)(s.strong,{children:"Redirect URI platform."})," Paste the ",(0,i.jsx)(s.code,{children:"GET auth endpoint URL"})," you copied from the ",(0,i.jsx)(s.strong,{children:"Microsoft Teams Bridge App Info"})," as the value."]}),"\n",(0,i.jsxs)(s.li,{children:["Click ",(0,i.jsx)(s.strong,{children:"Register"}),". Copy the ",(0,i.jsx)(s.strong,{children:"Application (client) ID"})," and ",(0,i.jsx)(s.strong,{children:"Directory (tenant) ID"})," shown on the overview page."]}),"\n",(0,i.jsxs)(s.li,{children:["Click ",(0,i.jsx)(s.strong,{children:"Add a certificate or secret > New Client Secret."})," Fill in the description and expiration timeline. Then, click ",(0,i.jsx)(s.strong,{children:"Add"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["After the client secret is created, copy the ",(0,i.jsx)(s.strong,{children:"Client Secret Value"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Navigate to ",(0,i.jsx)(s.strong,{children:"API permissions"})," > Select ",(0,i.jsx)(s.strong,{children:"Add a permission"}),' > Select "',(0,i.jsx)(s.strong,{children:"Microsoft Graph"}),'".']}),"\n",(0,i.jsx)(s.li,{children:"Add the set of required permissions. The table below outlines the required permissions you'll need to set."}),"\n"]}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Name"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Requires Admin Consent"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChannelMessage.Read.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read all channel messages"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChannelMessage.Send"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Send channel messages"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChannelMessage.UpdatePolicyViolation.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Flag channel messages for violating policy"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Chat.Create"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Create chats"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Chat.Create"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Create chats"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Chat.Read.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read all chat messages"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Chat.ReadBasic"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Read names and members of user chat threads"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Chat.ReadBasic.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read names and members of all chat threads"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Chat.ReadWrite"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Read and write user chat messages"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Chat.ReadWrite.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read and write all chat messages"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMember.Read"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Read the members of chats"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMember.Read.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read the members of all chats"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMember.Read.WhereInstalled"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read the members of all chats where the associated Teams application is installed."}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMember.ReadWrite"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Add and remove members from chats"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMember.ReadWrite.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Add and remove members from all chats"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMember.ReadWrite.WhereInstalled"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Add and remove members from all chats where the associated Teams application is installed."}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMessage.Read"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Read user chat messages"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMessage.Read.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read all chat messages"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ChatMessage.Send"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Send user chat messages"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"email"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"View users' email address"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Files.Read"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Read user files"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Files.Read.All"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Read all files that user can access"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Files.Read.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read files in all site collections"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Files.ReadWrite"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Have full access to user files"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Group.ReadWrite.All"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Read and write all groups"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"offline_access"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Maintain access to data you have given it access to"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"openid"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Sign users in"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"profile"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"View users' basic profile"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"ServiceMessage.Read.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read service messages"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"User.Read"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Sign in and read user profile"}),(0,i.jsx)(s.td,{children:"No"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"User.Read.All"}),(0,i.jsx)(s.td,{children:"Delegated"}),(0,i.jsx)(s.td,{children:"Read all users' full profiles"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"User.Read.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read all users' full profiles"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"User.ReadWrite.All"}),(0,i.jsx)(s.td,{children:"Application"}),(0,i.jsx)(s.td,{children:"Read and write all users' full profiles"}),(0,i.jsx)(s.td,{children:"Yes"})]})]})]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["After setting all permissions, click on ",(0,i.jsx)(s.strong,{children:"Grant admin consent for org"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"configure-microsoft-teams-bridge",children:"Configure Microsoft Teams Bridge"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Navigate to ",(0,i.jsx)(s.strong,{children:"Microsoft Teams Bridge"})," ",(0,i.jsx)(s.strong,{children:"App Info > Settings"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Update the ",(0,i.jsx)(s.strong,{children:"Microsoft Entra"})," ",(0,i.jsx)(s.strong,{children:"Directory (tenant) ID,  Microsoft Entra Application (client) ID"}),", and ",(0,i.jsx)(s.strong,{children:"Microsoft Entra Client Secret"})," with the values you copied earlier. Then, click ",(0,i.jsx)(s.strong,{children:"Save Changes"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.admonition,{type:"info",children:(0,i.jsx)(s.p,{children:"Ensure you use the correct credentials and set the appropriate API permissions on the Microsoft Entra ID."})}),"\n",(0,i.jsx)(s.h2,{id:"api-limitation",children:"API Limitation"}),"\n",(0,i.jsxs)(s.p,{children:["With the Microsoft Teams Bridge, you can exchange up to 500 messages per month across ",(0,i.jsx)(s.a,{href:"https://rocket.chat/",children:"Rocket.Chat"})," and MS Teams at no additional cost. If you surpass this limit, you can no longer exchange messages between ",(0,i.jsx)(s.a,{href:"https://rocket.chat/",children:"Rocket.Chat"})," and Teams."]}),"\n",(0,i.jsx)(s.p,{children:"If you intend to exchange more than 500 messages, here are some important details to note:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Check if the API is metered. Microsoft Teams has free and metered APIs that are billed based on usage. Know the metering unit to estimate API costs. There's a limit of 500 messages per month. Exceeding this limit means Teams messages won't show in Rocket.Chat, but it can still be sent."}),"\n"]}),"\n",(0,i.jsx)(s.admonition,{type:"info",children:(0,i.jsxs)(s.p,{children:["Read the ",(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/graph/teams-licenses",children:"documentation "}),"to learn more about the pricing models and licensing requirements."]})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"To monitor message count, set up an Azure budget to track messages against the threshold. Configure alerts to ensure you stay within the 500 messages monthly spending limit. For example, your organizational spending limit is 500 messages per month; email notifications are sent if the budget threshold is exceeded."}),"\n"]}),"\n",(0,i.jsx)(s.admonition,{type:"info",children:(0,i.jsxs)(s.p,{children:["See the official guide to understand how to ",(0,i.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/azure/cost-management-billing/costs/tutorial-acm-create-budgets",children:"create and manage"})," Azure budgets."]})}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsx)(s.p,{children:"This app was developed in partnership with Yuqing Bian during Google Summer of Code 2022."}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>d,x:()=>c});var i=t(96540);const r={},n=i.createContext(r);function d(e){const s=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(n.Provider,{value:s},e.children)}}}]);